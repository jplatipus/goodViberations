<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>blog: goodViberations app, built using AI Agent(s)</title>
    <link rel="stylesheet" href="img/styles.css?v=7">
</head>
<body>
<a href="ReadMe.html"><- ReadMe.html</a>
<h1>goodViberations blog</h1>
<h2>Introduction</h2>
<p>
    This file is maintained as the project progresses. The most recent entry is at the top of this
    file, the oldest at the bottom. This is how a blog works, I think.
</P>
<p>
    The project sources can be found on GitHub: <a href="https://github.com/jplatipus/goodViberations">
    https://github.com/jplatipus/goodViberations</a>
</p>
<h1>29 Jan 2026: git tag v8.0</h1>
    The functionality specification  for CreateNewStoreActivity is written in the file
<a href="functionality/CreateNewStoreFunctionality.html">CreateNewStoreFunctionality.html</a>.<br/>
The functionality specification  for ListEntriesActivity is written in the file
<a href="functionality/ListEntriesActivityFunctionality.html">ListEntriesActivityFunctionality.html</a>.<br/>
Some changes to the DataLayer functionality were also made. The following prompt was issued to Gemini:<br/><br/>
<cite>I have updated  @UIActivities.html   @Functionality.html   @DataLayer.html 
     @MainActivityFunctionality.html   @ListEntriesActivityFunctionality.html 
     @CreateNewStoreFunctionality.html specifications, can you update the code please</cite><br/><br/>
The agent starts the process, then, before completion, I get the message:<br/><br/>
<cite><strong>You have exceeded the limit of prompt requests per hour. Please try again later.</strong></cite><br/><br/>
The agent has left the codebase in an incomplete state that does not compile.
It is hoped that an hour later, asking the agent to complete the task will be successful.<br/><br/>
An hour later the following prompt was issued:<br/>
<cite>can you finish the task please</cite>
<br/><br/>
The agent finished the task, the code compiles and runs. The navigation bar at the bottom of the screen
is present in MainActivity and CreateNewStoreActivity, but not in ListEntriesActivity.
<br/><br/>
The agent window displays the message again:
<cite>You have exceeded the limit of prompt requests per hour. Please try again later.</cite>
<br/><br/>
This behaviour is becoming worrisome, just one prompt is too much for Gemini.

<h1>17 Jan 2026: git tag v7.0</h1>
<p>
    The data layer functionality can't be tested easily without having unit tests: the app must be run, and the
    activities that load, save, edit and delete entries would need to be run. For this reason unit tests
    have been specified in the DataLayerUnitTests.html file. It is ready to be run in Gemini.
</p>
<p>
    The implementation loads and saves the list of entries in an xml file. This will be used for
    import and export store too, but specifying a filename instead of the DataLayer persisting in
    context.filesDir, generating a filename of the form "info" + ddmmyyyyhhmmss + ".xml".
    <br/><br/>
    Some refactoring will be necessary at  later date to handle the import and export store in the DataLayer.
</p>
<p>
    A prompt is issued to check that the DataLayer class is OK, and to generate the unit tests:
    <br/><br/>
    <cite>
        I have specified unit tests in  @DataLayerUnitTests.html  for the DataLayer class specified
        in  @DataLayer.html . Could you check if the DataLayeer class needs to be modified,
        and also generate the unit tests please.
    </cite>
</p>
<p>
    Some snags were encountered. The gradle file build.gradle.kts(app) refers to an old robolectric library
    that does not support Android sdk 36. A quick check on the
    <a href="https://github.com/robolectric/robolectric/releases">roboelectric  github</a> points to a newer version.
    The gradle file is updated, and the build is synced. Rebuilding the project should works, but some unit test errors
    are occurring.
</p>
<p>
    The unit tests fail on saveStoreTest, this is because an attempt is made to save the file twice in a second
    thus overwriting the previous file, when it should be a new file. This has identified a bug in
    the spec for the data layer! The specification for createStore in <a href="DataLayer.html"><strong>
    DataLayer specification</strong></a>.
    has been updated to include a random number between 0 and 100. Unit tests now all pass. One snag
    is that sometimes Gemini changes the annotation in DataLayerUnitTests.kt
    from @Config(sdk = [36]) to @Config(sdk = [34]) which causes the unit test runner to fail with long and gryptic
    error messages. For now the error message is recognised by me, and the unit test file
    annotation updated. It is hoped that Gemini won't change build.gradle.kts(app) in the future. The line
    that specifies which version of robolectric to use was manually specified as
    testImplementation("org.robolectric:robolectric:4.16"), this one works with the Android SDK 36:
    <cite>
        testImplementation("org.robolectric:robolectric:4.16")
    </cite>
</p>
<p>
    The methods in the DataLayer have been updated to take a map instead of a list. This ensures that 
    the name used for an entry is unique. The following prompt is issued to generate the updated code:
    <br/><br/>
    <cite>I have updated  @DataLayer.html and  @DataLayerUnitTests.html </cite>
    <br/><br/>
    Attempting to run the unit tests, gives the error <i>Requires newer sdk version #36 (current version is #34)</i>.
    This is because Gemini has changed the line in DataLayerUnitTests to <i>@Config(sdk = [36])</i>. The line
    is manually set to be <i>@Config(sdk = [36])</i>. Some way of telling Gemini to leave the sdk version alone
    needs to be found. The following prompt is issued to inform Gemini of the changes I made:
    <br/><br/>
    <cite>
        I have updated  @build.gradle.kts to use<br/>
        org.robolectric:robolectric:4.16.<br/>
        This means that  @DataLayerUnitTests.kt can now use Android SDK 36
    </cite>
    <br/><br/>
    The unit tests now pass.
</p>
<h1>7 Jan 2026: git tag v6.0</h1>
    <table>
        <tr>
            <td style="vertical-align: top">

                <img src="img/Tag_V6_MaterialDesign3.png" alt="Tag_V6_MaterialDesign3.png"/><br/>
                Material 3 default colours
            <img src="img/Tag_V6_Colors.png" alt="Tag_V6_Colors.png"/><br/>
                Colours chosen for the app
            </td>

            <td style="vertical-align: top">
                <p>
                    The UI is very poor and needs to be improved. </p>
                <p>
                    The code does not use the latest "material design 3",
                    The following prompt is issued so that the agent can update the code to use the latest version:<br/><br/>
                    <cite>can you update the project UI to use material design 3 components</cite><br/>
                    The activity title covers the topmost widget in all the activities. To rectify that the following prompt
                    was issued to the agent:<br/><br/>
                    <cite>why does the title cover btnOpenStore?</cite>
                </p>
                <p>
                    The activity looks better now:<br/><br/>
                    Changing button colours (colour in english) using Gemini,
                    then asking it to remove back buttons
                    in the about and help activities caused some problems: it removed the ok button too. I put it back in
                    editing code. Then I hit something unexpected; <strong>Gemini tells me:</strong><br/><br/>
                    <cite>You have exceeded the limit of prompt requests per hour. Please try again later.</cite>.
                </p>
                <img src="img/GeminiIsFedUp.png" alt="Gemini is fed up"/>
                <p>This is not a friendly way to behave.</p>

            </td>
        </tr>
    </table>
<p>
    Work has started on adding more details to the <a href="DataLayer.html"><strong>DataLayer specification</strong></a>.
    The Android documentation has a section on app specific files: where they are kept,
    how they can be accessed, and importantly, best practises.
</p>
<p>
        <cite>
            It is recommended not to open
            and close files too often.
        </cite>
</p>
<p>
    The approach is to minimise reads and writes, and also to
    only write to a file once. In previous versions of Android, problems have been encountered when
    appending contents to a file, possibly due to caching. The hope is that only writing to a
    file once will avoid data loss.
</p>
<p>
    If there arises a subsequent need to add more fields to an existing file,
    a new file is created instead, with the updated list of fields.
    The filename is made up of
    "info" + ddmmyyyyhhmmss.xml, and no more than 5 files are kept (4 backups + the latest version).
</p>
<p>
    At present the specification defines a persistence class called <a href="DataLayer.html">DataLayer</a>. Once the specification
    is completed, work can move on to the main activity button functionalities that have not been
    addressed so far.
</p>
<h1>2 Jan 2026: git tag v5.0</h1>
<p>
    I am now working on <strong>tag v5.0</strong>.<br/><br/>
    There are a lot of activities in this project, quite a few are expected to perform many operations.
    It has been decided to create one functionality specification html file per activity. The
    functionality specification files are placed in a folder called functionality. As the project
    progresses, activity by activity, new functionality files are added. The UI specifications are
    moved across from <a href="UIActivities.html">UIActivities.html</a> to their new functionality
    specification file.
</p>
<p>
    The following is to be carried out:
    <ul>
        <li>Split up the original <a href= "Functionality.html">Functionality.html</a>. It now lists
        the activity functionality specification files, in effect a functionality table of
        contents.</li>
        <li>create the functionality specifications for:
            <ul>
                <li><a href="functionality/AboutActivityFunctionality.html">AboutActivity</a></li>
                <li><a href="functionality/HelpActivityFunctionality.html">HelpActivity</a></li>
                <li><a href="functionality/MainActivityFunctionality.html">MainActivity</a></li>
            </ul>
        </li>
    </ul>
    Once the above new specification files have been created, it should be possible to ask Gemini to
    update the activity classes with the new functionality.The generated code should be reviewed.
    It should be possible to compile and
    run the application. The application should have the appearance that is expected. The application
    should run as expected.
    <ul>
        <li>Navigation to the AboutActivity and HelpActivity should work.</li>
        <li>Navigation from AboutActivity and HelpActivity back to MainActivity should work.</li>
    </ul>
</p>
<p>
    I have issued some prompts to Gemini:
    </p>
<p>
    <cite>
        <blockquote>
            I have updated specification files:  @UIActivities.html   @Functionality.html 
             @MainActivityFunctionality.html   @AboutActivityFunctionality.html   @HelpActivityFunctionality.html 
        </blockquote>
    </cite>
</p>
<p>
    <cite>
        <blockquote>
            I have also updated the classes source code:  @AddEntryActivity.kt   @AboutActivity.kt   @ChangeStorePasswordActivity.kt   @CreateNewStoreActivity.kt   @DeleteEntryActivity.kt   @EditEntryActivity.kt   @HelpActivity.kt 
             @ImportExportStoreActivity.kt   @ListEntriesActivity.kt   @MainActivity.kt   @OpenStoreActivity.kt 
        </blockquote>
    </cite>
</p>
<p>
    <cite>
        <blockquote>
            the plan should specify that the asset filename  @MainActivityHelp.html is passed to
             @HelpActivity.kt by  @MainActivity.kt 
        </blockquote>
    </cite>

    Issuing the above prompts in the <strong>Ask tab</strong> of the Gemini chat caused Gemini to
    say it was making
    the changes but it did nothing.
    <br/><br/>
    Issuing the same prompts again in the <strong>Agent tab</strong> did cause Gemini
    to make code changes. It is adding more functionality than I expected. It has updated all the activities'
    help and back buttons too. I like what it did, I was planning to add the help and back button
    functionality in the specs for the other activities later, Gemini decided to do it now. It did
    not update AndroidManifest.xml, so I asked the agent a question:
    <cite>does @AndroidManifest.xml need to list every activity in the app?</cite>
    The agent duly replied yes to the question and updated the manifest.
</p>
<p>
    The app compiles, it also runs well, the navigation from the MainActivity to the AboutActivity
    and HelpActivity works. The back button in these activities also works. The UI is not pretty,
    and needs attention.
</p>
<p>
</p>
<h1>17 Dec 2025: git tag v4.0</h1>
<p>
    I am now working on <strong>tag v4.0</strong>.<br/><br/>
    The following is to be carried out:
    <ul>
        <li>add help file for MainActivity (html asset) to the project.</li>
        <li>add about file for AboutActivity (html asset) to the project.</li>
        <li>update MainActivity so that the help button navigates to the HelpActivity,
            specifying which help file to display.</li>
        <li>update MainActivity so that the about button navigates to the AboutActivity.</li>
        <li>add an ok button on the AboutActivity that navigates back to MainActivity.</li>
        <li>add an ok button on the HelpActivity that navigates back to MainActivity.</li>
        <li>specify class member variable names for all the UI widgets.</li>
    </ul>
    I did not know where html assets should be placed in the project, so I asked the agent:<br/><br/>
    <cite>where in the project should I put help files which are displayed to the user in the HelpActivity?</cite><br/></br/>
    The agent responded with the following helpful answer:<br/><br/>
    <cite>
        For help files, especially HTML content, the best practice is to place them in the assets directory.
        In your project, this would be located at /pathToThisProject/goodViberations/app/src/main/assets.
        If this folder doesn't exist, you should create it.<br/><br/>
        You can then access these files in your HelpActivity by using the AssetManager.
    </cite><br/>
</p>
<p>
    <ul>
        <li>New asset files have been created (About.html and MainActivityHelp.html) in the assets folder.</li>
        <li>The UIActivities specification has been updated to reflect the new asset folder structure.</li>
        <li>
            The AboutActivity UI specification and the HelpActivity UI specification
            have been updated to display the relevant html asset file.</li>
        <li>
            The AboutActivity UI specification and the HelpActivity UI specification have been updated to
            display an ok button added so that the activity can be popped
            off the activity stack.
        </li>
        <li>The Functionality specification has detail added for the navigation from the MainActivity to the AboutActivity and HelpActivity.</li>
    </ul>
</p>
<p>
    The   agent's context  has been cleared. I intend generate    to code   again from the specs.
</p>
<p>
    At this point I believe that everything intended for this build is now in place. It is time to ask the agent to perform the changes.
</p>
<p>
    The agent generated the UI code but did not add <cite>appcompat = "1.7.1"</cite>. I asked Gemini to do this,
    it claimed to have updated my gradle files, but it did not. So I did it manually<br/><br/>
    Adding the appcompat resolves the compilation errors.<br/><br/>
    I noticed that there is no code to generate a preview of each UI class. I asked Gemini to do this,
    but it did not. Gemini listed the code that it claimed to have added:<br/>

    <pre><cite>
        @Preview(showBackground = true, name = "About Activity Preview")
        @Composable
        fun AboutActivityPreview() {
            // This Composable wraps the XML layout for previewing.
            AndroidView(
                factory = { context ->
                    // Inflate the XML layout using the activity's context.
                    android.view.View.inflate(context, R.layout.activity_about, null)
                },
                update = { view ->
                    // You can add logic here to update the view in the preview if needed.
                    // For example, finding a button and setting its text.
                }
</cite></pre>
    But it didn't do it. I had to manually add this to each UI activity. Then I found that the XML layouts
    did not have the widget IDs specified. I asked Gemini to fix this:<br/><br/>
    <cite>all the activities layout files should have the android:id specified for each widget</cite>
    <br/><br/>
    This worked well.
</p>
</body>
</html>
